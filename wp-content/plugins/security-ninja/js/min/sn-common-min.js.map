{"version":3,"sources":["../sn-common.js"],"names":["sn_block_ui","content_el","jQuery","addClass","css","window","height","show","sn_fix_dialog_close","event","bind","target","id","dialog","sn_unblock_ui","removeClass","hide","wfsn_freemius_opt_in","element","nonce","val","choice","data","ajax","type","url","ajaxurl","async","action","opt_nonce","success","location","reload","error","xhr","textStatus","_error","console","log","statusText","document","ready","do_test","stepid","self","testid","_ajax_nonce","wf_sn","nonce_run_tests","testarr","dataType","response","replaceWith","label","fadeIn","outputmsg","msg","details","status","prop","scores","output","html","nexttest","parseInt","fail","statusCode","on","e","preventDefault","attr","checkedtests","thistestid","each","this","checked","push","fadeOut","hasClass","post","slideUp","remove","dialogClass","modal","resizable","zIndex","width","open","ui","close","autoOpen","closeOnEscape","Beacon","hash","scrollPos","scrollTop","find","tabs","activate","newPanel","cookie","active","tabtarget","replace","t","confirm","test_id","name","text","content","title","trigger","runtime","prepend","timestamp"],"mappings":"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","sourcesContent":["/* globals jQuery:true, ajaxurl:true, wf_sn:true, Beacon:true */\r\n/* eslint-enable no-unused-vars */\r\n/*\r\n* Security Ninja PRO\r\n* Main backend JS\r\n* (c) WP Security Ninja, 2012 - 2020\r\n*/\r\n\r\n\r\n// FOR THE SECOND COUNTER ON THE OVERLAY\r\n// ***** tODO - delete\r\n/*\r\nfunction SecScanTimeCounter() {\r\n\t++totalSeconds;\r\n\tsecondsLabel.innerHTML = pad(totalSeconds % 60);\r\n\tminutesLabel.innerHTML = pad(parseInt(totalSeconds / 60));\r\n}\r\n\r\nfunction pad(val) {\r\n\tvar valString = val + \"\";\r\n\tif (valString.length < 2) {\r\n\t\treturn \"0\" + valString;\r\n\t} else {\r\n\t\treturn valString;\r\n\t}\r\n}\r\n\r\nvar minutesLabel = document.getElementById(\"counterminutes\");\r\nvar secondsLabel = document.getElementById(\"counterseconds\");\r\nvar totalSeconds = 0;\r\n*/\r\n\r\nfunction sn_block_ui(content_el) {\r\n\tjQuery('html.wp-toolbar').addClass('sn-overlay-active');\r\n\tjQuery('#wpadminbar').addClass('sn-overlay-active');\r\n\tjQuery('#sn_overlay .wf-sn-overlay-outer').css('height', (jQuery(window).height() - 200) + 'px');\r\n\tjQuery('#sn_overlay').show();\r\n\t\r\n\tif (content_el) {\r\n\t\tjQuery(content_el, '#sn_overlay').show();\r\n\t}\r\n}\r\n\r\n\r\n\r\nfunction sn_fix_dialog_close(event) {\r\n\tjQuery('.ui-widget-overlay').bind('click', function(){ jQuery('#' + event.target.id).dialog('close'); });\r\n}\r\n\r\n\r\nfunction sn_unblock_ui(content_el) {\r\n\tjQuery('html.wp-toolbar').removeClass('sn-overlay-active');\r\n\tjQuery('#wpadminbar').removeClass('sn-overlay-active');\r\n\tjQuery('#sn_overlay').hide();\r\n\t\r\n\tif (content_el) {\r\n\t\tjQuery(content_el, '#sn_overlay').hide();\r\n\t}\r\n}\r\n\r\n\r\n/**\r\n* Stores opt-in or opt-out choice for user.\r\n* @param {*} element \r\n*/\r\nfunction wfsn_freemius_opt_in( element ) {\r\n\tvar nonce  = jQuery( '#wfsn-freemius-opt-nonce' ).val(); \r\n\tvar choice = jQuery( element ).data( 'opt' ); \r\n\t\r\n\tjQuery.ajax( {\r\n\t\ttype: 'POST',\r\n\t\turl: ajaxurl,\r\n\t\tasync: true,\r\n\t\tdata: {\r\n\t\t\taction: 'wfsn_freemius_opt_in',\r\n\t\t\topt_nonce: nonce,\r\n\t\t\tchoice: choice\r\n\t\t},\r\n\t\tsuccess: function( data ) {\r\n\t\t\tlocation.reload();\r\n\t\t},\r\n\t\terror: function( xhr, textStatus, error ) {\r\n\t\t\tconsole.log( xhr.statusText );\r\n\t\t\tconsole.log( textStatus );\r\n\t\t\tconsole.log( error );\r\n\t\t}\r\n\t} );\r\n}\r\n\r\njQuery(document).ready(function(){\r\n\t\r\n\t// RUN SELECTED TESTS\r\n\tjQuery(document).on('click', '#run-selected-tests', function(e) {\r\n\t\te.preventDefault();\r\n\t\tjQuery('#run-selected-tests').attr('disabled', true);\r\n\t\t\r\n\t\t// finds all selected tests, stores in array and sets visual testing styles\r\n\t\tlet checkedtests = [];\r\n\t\tlet thistestid = '';\r\n\t\tjQuery(\"input[name='sntest[]']\").each(function () {\r\n\t\t\tif (this.checked) {\r\n\t\t\t\tthistestid = jQuery(this).val();\r\n\t\t\t\tjQuery('.test_'+thistestid).addClass('testing');\r\n\t\t\t\tjQuery('.test_'+thistestid+' .spinner').addClass('is-active');\r\n\t\t\t\tjQuery('.test_'+thistestid+' .sn-result-details').hide();\r\n\t\t\t\tcheckedtests.push(thistestid);}\r\n\t\t\t});\r\n\t\t\t// Lets start with the first test\r\n\t\t\tdo_test(0,checkedtests,self);\r\n\t\t\t\r\n\t\t\tjQuery('#run-selected-tests').attr('disabled', false);\r\n\t\t\t\r\n\t\t});\r\n\t\t\r\n\t\t\r\n\t\t// QUICK FILTER - ALL\r\n\t\tjQuery(document).on('click', '#sn-quickselect-all', function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\tjQuery('#security-ninja :checkbox').prop(\"checked\", true);\r\n\t\t\t// Trigger selected\r\n\t\t\tjQuery('#security-ninja tr.test').fadeIn('fast');\r\n\t\t});\r\n\t\t\r\n\t\t\r\n\t\t// QUICK FILTER - FAILED\r\n\t\tjQuery(document).on('click', '#sn-quickselect-failed', function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\t// Hide all\r\n\t\t\tjQuery('#security-ninja :checkbox').prop(\"checked\", false);\r\n\t\t\t// Trigger selected\r\n\t\t\tjQuery('#security-ninja .wf-sn-test-row-status-0 :checkbox').prop(\"checked\", true);\r\n\t\t\t// hide the rest\r\n\t\t\tjQuery('#security-ninja .wf-sn-test-row-status-null').fadeOut('fast');\r\n\t\t\tjQuery('#security-ninja .wf-sn-test-row-status-10').fadeOut('fast');\r\n\t\t\tjQuery('#security-ninja .wf-sn-test-row-status-5').fadeOut('fast');\r\n\t\t\tjQuery('#security-ninja .wf-sn-test-row-status-0').fadeIn('fast');\r\n\t\t});\r\n\t\t\r\n\t\t\r\n\t\t// QUICK FILTER - WARNING\r\n\t\tjQuery(document).on('click', '#sn-quickselect-warning', function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\t// Hide all\r\n\t\t\tjQuery('#security-ninja :checkbox').prop(\"checked\", false);\r\n\t\t\t// Trigger selected\r\n\t\t\tjQuery('#security-ninja .wf-sn-test-row-status-5 :checkbox').prop(\"checked\", true);\r\n\t\t\t// hide the rest\r\n\t\t\tjQuery('#security-ninja .wf-sn-test-row-status-null').fadeOut('fast');\r\n\t\t\t\r\n\t\t\tjQuery('#security-ninja .wf-sn-test-row-status-10').fadeOut('fast');\r\n\t\t\tjQuery('#security-ninja .wf-sn-test-row-status-0').fadeOut('fast');\r\n\t\t\tjQuery('#security-ninja .wf-sn-test-row-status-5').fadeIn('fast');\r\n\t\t});\r\n\t\t\r\n\t\t\r\n\t\t// QUICK FILTER - OK\r\n\t\tjQuery(document).on('click', '#sn-quickselect-okay', function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\t// Hide all\r\n\t\t\tjQuery('#security-ninja :checkbox').prop(\"checked\", false);\r\n\t\t\t// Trigger selected\r\n\t\t\tjQuery('#security-ninja .wf-sn-test-row-status-10 :checkbox').prop(\"checked\", true);\r\n\t\t\t// hide the rest\r\n\t\t\tjQuery('#security-ninja .wf-sn-test-row-status-0').fadeOut('fast');\r\n\t\t\tjQuery('#security-ninja .wf-sn-test-row-status-5').fadeOut('fast');\r\n\t\t\tjQuery('#security-ninja .wf-sn-test-row-status-10').fadeIn('fast');\r\n\t\t\tjQuery('#security-ninja .wf-sn-test-row-status-null').fadeOut('fast');\r\n\t\t\t\r\n\t\t});\r\n\t\t\r\n\t\t\r\n\t\t// QUICK FILTER - UNTESTED\r\n\t\tjQuery(document).on('click', '#sn-quickselect-untested', function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\t// Hide all\r\n\t\t\tconsole.log('untested');\r\n\t\t\tjQuery('#security-ninja :checkbox').prop(\"checked\", false);\r\n\t\t\t// Trigger selected\r\n\t\t\tjQuery('#security-ninja .wf-sn-test-row-status-null :checkbox').prop(\"checked\", true);\r\n\t\t\t// hide the rest\r\n\t\t\tjQuery('#security-ninja .wf-sn-test-row-status-0').fadeOut('fast');\r\n\t\t\tjQuery('#security-ninja .wf-sn-test-row-status-5').fadeOut('fast');\r\n\t\t\tjQuery('#security-ninja .wf-sn-test-row-status-10').fadeOut('fast');\r\n\t\t\tjQuery('#security-ninja .wf-sn-test-row-status-null').fadeIn('fast');\r\n\t\t\t\r\n\t\t});\r\n\t\t\r\n\t\t// stepid = integer\r\n\t\t// data = array of tests\r\n\t\tfunction do_test( stepid, data, self ) {\r\n\t\t\t\r\n\t\t\tlet testid = data[stepid];\r\n\t\t\t\r\n\t\t\tjQuery('.test_'+testid).addClass('testing');\r\n\t\t\tjQuery('.test_'+testid+' .spinner').addClass('is-active');\r\n\t\t\tjQuery('.test_'+testid+' .sn-result-details').hide();\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tjQuery.ajax({\r\n\t\t\t\ttype: 'POST',\r\n\t\t\t\turl: ajaxurl,\r\n\t\t\t\tdata: {\r\n\t\t\t\t\t'_ajax_nonce': wf_sn.nonce_run_tests,\r\n\t\t\t\t\t'testarr': data,\r\n\t\t\t\t\t'action': 'sn_run_single_test',\r\n\t\t\t\t\t'stepid': stepid\r\n\t\t\t\t},\r\n\t\t\t\tdataType: \"json\",\r\n\t\t\t\tsuccess: function( response ) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tjQuery('.test_'+testid+' .spinner').removeClass('is-active');\r\n\t\t\t\t\t\r\n\t\t\t\t\tjQuery('.test_'+testid+' .wf-sn-label').replaceWith(response.data.label).fadeIn('slow');\r\n\t\t\t\t\t\r\n\t\t\t\t\tjQuery('.test_'+testid).removeClass('testing');\r\n\t\t\t\t\t\r\n\t\t\t\t\t//\tjQuery('.test_'+testid+' .sn-result-details').replaceWith('<span class=\"sn-result-details\">'+ response.data.msg +'</span>').fadeIn('slow');\r\n\t\t\t\t\t// @todo\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar outputmsg = response.data.msg;\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (response.data.details) {\r\n\t\t\t\t\t\toutputmsg = outputmsg +' '+response.data.details;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tjQuery('.test_'+testid+' .sn-result-details').replaceWith('<span class=\"sn-result-details\">'+ outputmsg +'</span>').fadeIn('slow');\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Fjerner gamle class værdier\r\n\t\t\t\t\tjQuery('.test_'+testid).removeClass(\r\n\t\t\t\t\t\t'wf-sn-test-row-status-0').removeClass('wf-sn-test-row-status-5').removeClass('wf-sn-test-row-status-10').removeClass('wf-sn-test-row-status-null').addClass('wf-sn-test-row-status-'+response.data.status);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tjQuery('.test_'+testid+' input[type=\"checkbox\"]').prop('checked', false);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (response.data.scores.output) {\r\n\t\t\t\t\t\t\tjQuery('#testscores').html( response.data.scores.output );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif( '-1' == response.data.nexttest ) {\r\n\t\t\t\t\t\t\t//\t\t\t\tjQuery('#counters').text('Testing completed - Reloading...');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tif ( parseInt(response.data.nexttest) > 0 ) {\r\n\t\t\t\t\t\t\t\tdo_test( parseInt( response.data.nexttest ), data, self );\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t}).fail(function (response) {\r\n\t\t\t\t\tif ( window.console && window.console.log ) {\r\n\t\t\t\t\t\twindow.console.log( response.statusCode+' '+response.statusText );\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\r\n\t\t\tjQuery('.wfsn-dismiss-review-notice, .wfsn-review-notice .notice-dismiss').on('click', function() {\r\n\t\t\t\tif ( ! jQuery(this).hasClass('wfsn-reviewlink') ) {\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t}\r\n\t\t\t\tjQuery.post( ajaxurl, {\r\n\t\t\t\t\taction: 'wf_sn_dismiss_review'\r\n\t\t\t\t});\r\n\t\t\t\tjQuery('.wfsn-review-notice').slideUp().remove();\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tjQuery('#test-details-dialog').dialog({\r\n\t\t\t\t'dialogClass': 'wp-dialog sn-dialog',\r\n\t\t\t\t'modal': true,\r\n\t\t\t\t'resizable': false,\r\n\t\t\t\t'zIndex': 9999,\r\n\t\t\t\t'width': 750,\r\n\t\t\t\t'height': 'auto',\r\n\t\t\t\t'hide': 'fade',\r\n\t\t\t\t'open': function(event, ui) {\r\n\t\t\t\t\tsn_fix_dialog_close(event, ui);\r\n\t\t\t\t},\r\n\t\t\t\t'close': function() {\r\n\t\t\t\t\tjQuery('#test-details-dialog').html('<p>Please wait.</p>')\r\n\t\t\t\t},\r\n\t\t\t\t'show': 'fade',\r\n\t\t\t\t'autoOpen': false,\r\n\t\t\t\t'closeOnEscape': true\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t// Opens Help Scout\r\n\t\t\tjQuery(document).on('click', '.openhelpscout', function() {\r\n\t\t\t\tBeacon(\"open\");\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t// sets the active tab via #hash in URL parameters\r\n\t\t\tvar hash = window.location.hash;\r\n\t\t\t\r\n\t\t\tif(hash) {\r\n\t\t\t\tvar scrollPos = jQuery(window).scrollTop();\r\n\t\t\t\t// Change to the right tab\r\n\t\t\t\tjQuery(\"#wf-sn-tabs\").find(\"a\").removeClass(\"nav-tab-active\");\r\n\t\t\t\tjQuery(\".wf-sn-tab\").removeClass(\"active\");\r\n\t\t\t\t\r\n\t\t\t\tjQuery('a[href=\"' + hash +'\"]').addClass('nav-tab-active').removeClass('hidden');\r\n\t\t\t\tjQuery(hash).addClass('active');\r\n\t\t\t\t\r\n\t\t\t\tjQuery(this).addClass(\"nav-tab-active\");\r\n\t\t\t\tjQuery(window).scrollTop(scrollPos);\r\n\t\t\t\t\r\n\t\t\t\tjQuery('[name=\"_wp_http_referer\"]').val(window.location);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tjQuery('#wf-sn-tabs').tabs({\r\n\t\t\t\tactivate: function(event, ui) {\r\n\t\t\t\t\t// save current scroll position\r\n\t\t\t\t\tvar scrollTop = jQuery(window).scrollTop();\r\n\t\t\t\t\t// add hash to url\r\n\t\t\t\t\twindow.location.hash = ui.newPanel.attr('id');\r\n\t\t\t\t\t// keep scroll at current position\r\n\t\t\t\t\tjQuery(window).scrollTop(scrollTop);\r\n\t\t\t\t}\r\n\t\t\t}).fadeIn('fast');\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t// init tabs\r\n\t\t\tjQuery('#tabs').tabs({\r\n\t\t\t\tactivate: function(  ) {\r\n\t\t\t\t\tjQuery.cookie('sn_tabs_selected', jQuery('#tabs').tabs('option', 'active'));\r\n\t\t\t\t},\r\n\t\t\t\tactive: jQuery('#tabs').tabs({ active: jQuery.cookie('sn_tabs_selected') })\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t// Tab handling\r\n\t\t\tjQuery(\"#wf-sn-tabs\").find(\"a\").on('click', function(e) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tjQuery(\"#wf-sn-tabs\").find(\"a\").removeClass(\"nav-tab-active\"),\r\n\t\t\t\tjQuery(\".wf-sn-tab\").removeClass(\"active\");\r\n\t\t\t\tvar tabtarget = jQuery(this).attr(\"id\").replace(\"-tab\", \"\");\r\n\t\t\t\tvar t = jQuery(\"#\" + tabtarget);\r\n\t\t\t\tt.addClass(\"active\"),\r\n\t\t\t\tjQuery(this).addClass(\"nav-tab-active\"),\r\n\t\t\t\tt.hasClass(\"nosave\") ? jQuery(\"#submit\").hide() : jQuery(\"#submit\").show();\r\n\t\t\t\tvar scrollPos = jQuery(window).scrollTop();\r\n\t\t\t\twindow.location.hash = tabtarget;\r\n\t\t\t\tjQuery(window).scrollTop(scrollPos);\r\n\t\t\t\tjQuery('[name=\"_wp_http_referer\"]').val(window.location);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t// Asks before importing settings\r\n\t\t\tjQuery(document).on('click', '#wf-import-settings-button', function() {\r\n\t\t\t\tif (!confirm('Are you sure you want to import and overwrite the current settings?')) { //i8n\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t// abort scan by refreshing\r\n\t\t\tjQuery('#abort-scan').on('click', function(e){\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\twindow.location.reload();\r\n\t\t\t}); // abort scan\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t// show test details/help/fix dialog\r\n\t\t\t\r\n\t\t\tjQuery(document).on('click', '#sn_tests .sn-details a.button', function(e) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\t\r\n\t\t\t\tvar test_id = jQuery(this).data('test-id');\r\n\t\t\t\t\r\n\t\t\t\tvar name = jQuery('#' + test_id + ' .test_name').text();\r\n\t\t\t\tvar content = jQuery('#' + test_id + ' .test_description').html();\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t// get_single_test_details\r\n\t\t\t\t\r\n\t\t\t\tif (name === '') {\r\n\t\t\t\t\tname = 'Unknown test ID';\r\n\t\t\t\t\tcontent = 'Help is not available for this test. Make sure you have the latest version of Security Ninja installed.';\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tcontent = '<span class=\"ui-helper-hidden-accessible\"><input type=\"text\"></span><div id=\"testtimedetails\"><span class=\"spinner\"></span></div>' + jQuery('#' + test_id + ' .test_description').html();\r\n\t\t\t\t\t\r\n\t\t\t\t\tcontent += '<div id=\"auto-fixer-content-cont\"><hr><h3>Auto Fixer</h3><div id=\"auto-fixer-content\"></div></div>';\r\n\t\t\t\t\t// @i8n\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tjQuery('#test-details-dialog').html(content);\r\n\t\t\t\t\r\n\t\t\t\tjQuery('#test-details-dialog').dialog('option', { title: name, test_id: test_id } ).dialog('open');\r\n\t\t\t\tjQuery(document).trigger('sn_test_details_dialog_open', [ test_id, jQuery(this).data('test-status') ] );\r\n\t\t\t\t\r\n\t\t\t\tjQuery('#testtimedetails .spinner').addClass('is-active');\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tjQuery.ajax({\r\n\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\turl: ajaxurl,\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t'_ajax_nonce': wf_sn.nonce_run_tests,\r\n\t\t\t\t\t\t'action': 'sn_get_single_test_details',\r\n\t\t\t\t\t\t'testid': test_id\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdataType: \"json\",\r\n\t\t\t\t\tsuccess: function( response ) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (response.success) {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (response.data.runtime) {\r\n\t\t\t\t\t\t\t\tjQuery('#testtimedetails').prepend('<span id=\"runtime\"> Runtime: '+response.data.runtime+' sec.</span>');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (response.data.timestamp) {\r\n\t\t\t\t\t\t\t\tjQuery('#testtimedetails').prepend('<span id=\"lasttest\">Last test: '+response.data.timestamp+'</span>');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tjQuery('#testtimedetails .spinner').remove();\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t},\r\n\t\t\t\t\terror: function() {\r\n\t\t\t\t\t\tjQuery('#testtimedetails .spinner').remove();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\treturn false;\r\n\t\t\t}); // show test details dialog\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t});"]}